## 1. Тема и Целевая Аудитория

Steam — это цифровая платформа для дистрибуции видеоигр, программного обеспечения и общения, где пользователи могут покупать, скачивать, обновлять и играть в игры, а также взаимодействовать с игровым сообществом.

- Число активных пользователей
  - MAU (информация для конца 2021; с 2022 года Steam не предоставляет открытой информации по MAU и DAU): 132 млн. [^1]
  - В пике: 36,7 млн. [^2]
![image](https://github.com/user-attachments/assets/e6b06e84-8030-4fc1-bdbb-1e96cd69a344)

- Целевая аудитория
  - По странам [^3]:
![image](https://github.com/user-attachments/assets/6facf817-839b-4c68-8a38-c2fdd7343895)
![image](https://github.com/user-attachments/assets/1fc000a9-055e-4985-9151-718764085915)
  - По возрасту [^4]:
    | Возрастная группа | Процент пользователей |
    |-------------------|-----------------------|
    | 18-19 лет         | 8%                    |
    | 20-29 лет         | 37%                   |
    | 30-39 лет         | 32%                   |
    | 40-49 лет         | 15%                   |
    | 50-59 лет         | 7%                    |
  - По характеристикам систем [^5]:
![image](https://github.com/user-attachments/assets/fd10cd76-62e8-46a3-8655-3b252e6b7d05)


- Требования к функционалу
  - MVP:
    - Регистрация и авторизация
    - Магазин игр
    - Страница игры с возможностью купить игру (или активировать ключ, купленный на сторонней площадке)
    - Библиотека игр пользователя
    - Установка купленной игры
    - Профиль
  - Особенности решения:
    - Копии игр хранятся в сжатом виде. Т.е. пользователь скачивает некий архив, который на лету разархивируется в исполняемые файлы. Таким образом можно сэкономить нагрузку на сеть и хранилище в ЦОДах, но при этом повысится нагрузка на ПК пользователей.
    - Steam работает как клиентское приложение на ПК (есть и браузерная версия, которая предоставляет ограниченный функционал) и использует gRPC вместо классического HTTP, что тоже снижает нагрузку на сеть.
   

## 2. Расчёт нагрузки

### Продуктовые метрики

- MAU: 135 млн. уникальных пользователей [^1]
- DAU: 69 млн. уникальных пользователей [^1]
- Дневной пик по количеству активных пользователей: 36.7 млн. [^4]

Средний занимаемый размер хранилища пользователем:
| Какие данные      | Их размер             |
|-------------------|-----------------------|
| Аватар пользователя         | 1 МБ        |
| Скриншоты пользователя      | 5 МБ        |
| Данные пользователя         | 1 МБ        |

**Под данными пользователя подразумеваются: никнейм, список друзей, комментарии в профиле, описание профиля, витрина достижений и т.п.*

Средний занимаемый размер хранилища продуктом (видеоигрой):
| Какие данные      | Их размер                |
|-------------------|--------------------------|
| Исполняемые файлы игры (*)         | 15 ГБ   |
| Текстовые описания и хар-ки игры   | 1 МБ    |
| Медиафайлы (изображения, трейлеры) | 20 МБ   |

**На данный момент в steam около 71 тыс. игр, однако большинство из них - инди-игры, вес которых зачастую не доходит даже до 5 ГБ. Тем не менее, популярностью пользуются ААА-игры, размер которых может быть гораздо больше 15 ГБ. Поэтому с точки зрения "холодного" хранения исполняемых файлов, 15 ГБ - справедливое число, однако основная аудитория будет скачивать именно ААА-игры, поэтому под "горячее" хранение следует выбрать другое число и выбрать подходящий алгоритм для раздачи популярного контента*

Основные действия по функционалу MVP:
| Действие | Кол-во в день на одного пользователя в среднем |
|--------------------|-----------------------|
| Авторизация                           | 0,032   (1 в месяц)   |
| Регистрация                           | 0,0027  (1 в год)     | 
| Открытие и просмотр страницы магазина | 1                     |
| Покупка игры                          | 0,032 (1 в месяц)     |
| Написание отзыва на игру              | 0,021 (примерно 2/3 юзеров оставляют отзывы [^6] и оставить его можно только после покупки) |
| Просмотр профиля пользователя         | 0,5                   |
| Написание комментария в профиль       | 0,032 (1 в месяц)     |
| Загрузка скриншота                    | 0,142 (1 в неделю)    |
| Отправка заявки в друзья              | 0,032 (1 в месяц)     |
| Скачивание или обновление игры        | 0,142 (1 в неделю)    |

### Технические метрики

- Хранилище:
  На данный момент в Steam около 71 тыс. игр [^7]. Средний размер игры - 15 ГБ (пояснение см. выше). Итак, 15 ГБ * 71 000 ~ 1 040 ТБ ~ 1,01 ПБ на хранение исполняемых файлов. Для хранения информации, находяшейся на странице игры в магазине, нужно хранить тексктовые данные (включая локализации, технические характеристики и т.п.) ~ 1 МБ и медиафайлы ~ 20 МБ, тогда (20 МБ + 1 МБ) * 71 000 = 1 456 ГБ ~ 1,42 ТБ.
  Открытой информации по количеству аккаунтов в Steam на 2024 или хотя бы 2023 нет, однако известно, что к 2020 были зарегистрированы 667 млн. аккаунтов [^8], а пик игроков - 24,8 млн. [^9]. Если считать, что зависимость между пиком игроков и количеством зарегистрированных пользователей линейная, то получаем 36 700 000 / 24 800 000 * 667 000 000 = 987 млн. игроков. Тогда: 987 000 000 * (1 МБ + 5 МБ + 1 МБ) ~ 6588,93 ТБ ~ 6,43 ПБ

  Итого на хранилище: ~ 7,44 ПБ

- Сетевой трафик:
  Настоящая статистика за последние 48 часов по данным Steam [^10]: <img width="905" alt="image" src="https://github.com/user-attachments/assets/8bb8f79b-c0e2-46af-9300-f23f2a64d6b2">

  Попробуем посчитать средний трафик для MVP, описанного выше. Основной трафик будет приходиться на просмотр магазина, профиля и скачивание \ обновление игры:
  - Просмотр страницы игры в магазине: 1 * 69 000 000 * (20 МБ + 1 МБ) / 24 / 60 / 60 = 16,37 ГБ/c = 131,02 Гбит/c
  - Просмотр профиля игрока: 0,5 * 69 000 000 * (1 МБ + 5 МБ + 1 МБ) / 24 / 60 / 60 = 2,73 ГБ/c = 21,84 Гбит/с
  - Скачивание \ обновление игры: 0,142 * 69 000 000 * 15 ГБ / 24 / 60 / 60 = 1701 ГБ/с = 1,66 ТБ/c = 13,29 Тбит/с

  То же, но в пике (по графику выше это примерно x1,5):
  - Просмотр страницы игры в магазине: 131,02 Гбит/c * 1,5 = 196,53 Гбит/с
  - Просмотр профиля игрока: 21,84 Гбит/с * 1,5 = 32,76 Гбит/с
  - Скачивание \ обновление игры: 13,29 Тбит/с * 1,5 = 19,94 Тбит/с

  Потребление трафика за сутки:
  - Просмотр страницы игры в магазине: 131,02 Гбит/c * 60 * 60 * 24 = 10,8 Пбит = 1,35 ПБ
  - Просмотр профиля игрока: 21,84 Гбит/с * 60 * 60 * 24 = 1,8 Пбит = 0,025 ПБ
  - Скачивание \ обновление игры: 13,29 Тбит/с * 60 * 60 * 24 = 1121 Пбит = 140 ПБ

- RPS

  Используя данные выше, получаем:
  | Действие      | RPS             | RPS с учётом пика (x1,5) |
  |---------------|-----------------|--------------------------|
  | Авторизация                           | 26,3 RPS   | 39,45 RPS |
  | Регистрация                           | 2,2 RPS    | 3,3 RPS   |
  | Открытие и просмотр страницы магазина | 798 RPS    | 1197 RPS  |
  | Покупка игры                          | 26,3 RPS   | 39,45 RPS |
  | Написание отзыва на игру              | 16,8 RPS   | 25,2 RPS  |
  | Просмотр профиля пользователя         | 399 RPS    | 598,5 RPS |
  | Написание комментария в профиль       | 26,3 RPS   | 39,45 RPS |
  | Загрузка скриншота                    | 113 RPS    | 169,5 RPS |
  | Отправка заявки в друзья              | 26,3 RPS   | 39,45 RPS |


[^1]: https://backlinko.com/steam-users
[^2]: https://store.steampowered.com/charts
[^3]: https://worldpopulationreview.com/country-rankings/steam-users-by-country
[^4]: https://www.demandsage.com/steam-statistics/
[^5]: https://store.steampowered.com/hwsurvey/
[^6]: https://www.retail.ru/news/issledovanie-rekomendatsii-i-otzyvy-v-internete-chitayut-99-onlayn-pokupateley-2-sentyabrya-2020-197335/
[^7]: https://gamalytic.com/blog/steam-revenue-infographic
[^8]: https://cyber.sports.ru/games/1082667359-v-steam-zaregistrirovano-okolo-667-millionov-akkauntov.html
[^9]: https://app2top.ru/analytics/120-mln-aktivny-h-pol-zovatelej-ezhemesyachno-i-31-3-mlrd-igrovy-h-chasov-steam-podvel-itogi-2020-goda-180149.html
[^10]: https://store.steampowered.com/stats/content/



